# Simple WebAuthn Example

This project demonstrates a basic implementation of WebAuthn (Web Authentication) using Node.js and Express. WebAuthn is a web standard published by the World Wide Web Consortium (W3C). It enables strong, passwordless authentication using public key cryptography, making it more secure and user-friendly compared to traditional password-based authentication.

## Introduction

WebAuthn (Web Authentication) is part of the FIDO2 set of specifications, which collectively enable users to authenticate securely on the web. This example project showcases how to leverage the `@simplewebauthn/server` library to facilitate WebAuthn-based user registration and authentication.

The `@simplewebauthn/server` library simplifies the integration of WebAuthn into your Node.js applications. It provides utility functions to generate WebAuthn options and to verify the responses from the client's WebAuthn API.

## Passkeys
Passkeys represent a compelling WebAuthn-based alternative to the timeless combination of "password + second-factor" that we all suffer through.

Passkeys are phishing-resistant, are unique across every website, and can help users maintain account access after device loss.

Additionally, passkeys generated by the three main platform authenticator vendors (Apple, Google, and Microsoft) are automatically synchronized across a user's devices by their respective cloud account. That means there's finally an easy way for users to regain account access if they happen to lose or trade in their device. There's never been a better time to update your authentication to use WebAuthn.

The following options are ones you should set when calling SimpleWebAuthn's methods to ensure that your site is ready for passkeys.

**This project focuses on usage of passkeys where user can register challenge / login challenge and verify the response**

For more details about library on passkeys visit [SimpleWebAuthn/passkeys](https://simplewebauthn.dev/docs/advanced/passkeys)

## Prerequisites

- Node.js (>= 14.x)
- npm or yarn
- Apple: iOS 16, macOS 13 (Ventura, Safari-only)
- Google: Android 9+
- Microsoft: TBD



## Installation

1. Clone the repository:

```sh
git clone https://github.com/your-username/simple-webauthn-example.git
cd simple-webauthn-example
```

Install the dependencies:
    
    ```sh
    npm install
    ```
## Usage
```sh
npm start
```
Open your browser and navigate to `http://localhost:3000` to view the application.
Open your browser and navigate to http://localhost:3000.

## API Endpoints
### Register User
#### POST /register
Registers a new user.

Request Body:
```json
{
  "username": "john.doe",
  "displayName": "John Doe"
}
```
Response:
```json
{
    "id": "user_1234567890"
}
```

### Generate Registration Challenge
#### POST /register/challenge
Generates a registration challenge for a user.

Request Body:
```json
{
  "id": "user_1234567890"
}
```
Response:
```json
{
    "challenge":
    {
        "rp": {
            "name": "Simple WebAuthn Example"
        },
        "user": {
            "id": "user_1234567890",
            "name": "john.doe",
            "displayName": "John Doe"
        },
        "pubKeyCredParams": [
            {
                "type": "public-key",
                "alg": -7
            },
            {
                "type": "public-key",
                "alg": -257
            }
        ],
        "timeout": 60000,
        "attestation": "direct"
    }
}
```

### Verify Registration
#### POST /register/verify
Verifies the user's registration response.

Request Body:
```json
{
    "userId": "user_1234567890",
    "credential": {
        // WebAuthn credential response
    }
}

```

Response:
```json
{
  "verified": true
}

```
### Generate Login Challenge
#### POST /login/challenge
Generates a login challenge for a user.

Request Body:
```json
{
  "userId": "user_1234567890"
}
```
### Verify Login
#### POST /login-verify
Verifies the user's login response.

Request Body:
```json
{   
    "userId": "user_1234567890",
    "credential": {
        // WebAuthn credential response
    }
}
```
Response:
```json
{
  "verified": true,
  "user": "exampleUser"
}
```

## Code Explanation
`@simplewebauthn/server` Library
The @simplewebauthn/server library provides the following key functions used in this project:

* `generateRegistrationOptions`: Generates the options required for a user to register a new credential with WebAuthn.
* `verifyRegistrationResponse`: Verifies the response received from the client after a user attempts to register a new credential.
* `generateAuthenticationOptions`: Generates the options required for a user to authenticate with an existing credential.
* `verifyAuthenticationResponse`: Verifies the response received from the client after a user attempts to authenticate.

### Key Components
The components are used as In-ry stores and should be replaced by actual DB or some persistent storage in future
* `userstore`: An in-memory store for user data.
* `challengeStore`: An in-memory store for WebAuthn challenges. 

### Routes
* `/register`: Handles user registration.
* `/register/challenge`: Generates a registration challenge for the user.
* `/register/verify`: Verifies the user's registration response.
*` /login/challenge`: Generates a login challenge for the user.
* ` /login-verify`: Verifies the user's login response.


## License

```css

This version of the `Readme.md` provides a more detailed introduction to the WebAuthn protocol, a clearer explanation of the `@simplewebauthn/server` library, and a thorough breakdown of the API endpoints and their purposes. 
Adjust the repository URL and any other details to match your project's specifics.
```
